{"version":3,"sources":["assets\\Script\\cell.js"],"names":["cc","Class","Component","properties","_status","_itemType","warningSprite","Sprite","lightSprite","init","g","data","width","itemType","pos","_game","x","y","warningType","isPush","bindEvent","color","Math","ceil","random","colorSprite","node","getChildByName","getComponent","spriteFrame","propSpriteFrame","blockSprite","_width","_controller","active","height","startTime","iid","jid","gap","rotation","playStartAction","changeItemType","type","onWarning","warningSpriteFrame","action1","blink","warningInit","growInit","growType","grow","on","Node","EventType","TOUCH_START","onTouched","isChain","isBomb","time","setTimeout","JSON","stringify","self","playDieAction","then","onBlockPop","isSingle","scale","_score","tipBox","scaleTo","action2","easing","easeBackOut","action","sequence","runAction","onUserTouched","onStep","res","checkNeedFall","musicMgr","onPlayAudio","onItem","addScore","v2","config","json","propConfig","score","map","rowNum","playFallAction","moveBy","blockWidth","easeBounceOut","seq","callFunc","scaleX","scaleY","animationSpeed","clearTimeout","surfaceTimer","stopAllActions","Promise","resolve","reject","moveTo","target","action3","spawn","surfaceAction","dela","generatePropAction","generateItem"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\n * @author uu\n * @file 单个方块控制\n */\ncc.Class({\n  extends: cc.Component,\n  properties: {\n    _status: 0, //1为可触发点击 2为已经消失\n    _itemType: 0, //新增道具功能 1为双倍倍数 2为炸弹\n    warningSprite: cc.Sprite,\n    lightSprite: cc.Sprite,\n  },\n  init(g, data, width, itemType, pos) {\n    this._game = g\n    this._status = 1\n    if (pos) {\n      //cc.log('生成的方块', pos)\n    }\n    pos = pos || {\n      x: data.x,\n      y: data.y\n    }\n    this._itemType = itemType || 0\n    this.warningType = 0\n    this.isPush = false\n    this.bindEvent()\n    this.color = data.color || Math.ceil(Math.random() * 4)\n    this.colorSprite = this.node.getChildByName('color').getComponent(cc.Sprite)\n    this.colorSprite.spriteFrame = itemType ? g.propSpriteFrame[(itemType - 1) * 4 + this.color - 1] : this._game.blockSprite[this.color - 1]\n    this.warningSprite.spriteFrame = ''\n    this._width = width\n    this._controller = g._controller\n    // 计算宽\n    this.lightSprite.node.active = false\n    //  this.lightSprite.spriteFrame = this._game.blockSprite[this.color - 1]\n    this.node.width = this.node.height = width\n    this.startTime = data.startTime\n    this.iid = data.y\n    this.jid = data.x\n    // console.log('生成方块位置', data.y, data.x)\n    this.node.x = -(730 / 2 - g.gap - width / 2) + pos.x * (width + g.gap)\n    this.node.y = (730 / 2 - g.gap - width / 2) - pos.y * (width + g.gap)\n    this.node.rotation = 0\n    this.playStartAction()\n\t},\n\tchangeItemType(type){\n\t\tthis._itemType=type\n\t\tthis.colorSprite.spriteFrame = type ? this._game.propSpriteFrame[(type - 1) * 4 + this.color - 1] : this._game.blockSprite[this.color - 1]\n\t},\n  onWarning(type) {\n    this.warningSprite.spriteFrame = this._game.warningSpriteFrame[type - 1] || ''\n    this.warningType = type\n    //   this.lightSprite.node.active = true\n    let action1 = cc.blink(1, 10)\n    //   this.lightSprite.node.runAction(action1)\n  },\n  warningInit() {\n    this.warningSprite.spriteFrame = ''\n    //  this.lightSprite.node.active = false\n    this.isPush = false\n  },\n  growInit() {\n    this.growType = 0\n    this.colorSprite.node.height = this.colorSprite.node.width = this._width\n    this.colorSprite.node.y = this.colorSprite.node.x = 0\n  },\n  grow(type) { //1234 上下左右\n    switch (type) {\n      case 1:\n        if (this.growType != 2) {\n          this.colorSprite.node.height += this._game.gap * 2\n          this.colorSprite.node.y += this._game.gap\n          this.growType = 1\n        }\n        break\n      case 2:\n        if (this.growType != 2) {\n          this.colorSprite.node.height += this._game.gap * 2\n          this.colorSprite.node.y -= this._game.gap\n          this.growType = 1\n        }\n        break\n      case 3:\n        if (this.growType != 1) {\n          this.colorSprite.node.width += this._game.gap * 2\n          this.colorSprite.node.x -= this._game.gap\n          this.growType = 2\n        }\n        break\n      case 4:\n        if (this.growType != 1) {\n          this.colorSprite.node.width += this._game.gap * 2\n          this.colorSprite.node.x += this._game.gap\n          this.growType = 2\n        }\n        break\n    }\n  },\n  bindEvent() {\n    this.node.on(cc.Node.EventType.TOUCH_START, this.onTouched, this)\n\n  },\n  // 用户点击 或者被其他方块触发\n  onTouched(color, isChain, isBomb, time) { //道具新增参数 isChain是否连锁 isBomb是否强制消除\n    if (time) {\n      setTimeout(() => {\n        this.onTouched(color, false, isBomb)\n      }, time)\n      return\n    }\n    isChain = JSON.stringify(isChain) == 'null' ? true : isChain\n    isBomb = isBomb ? isBomb : false\n    color=color||this.color\n    let self = this\n    // 爆炸触发\n    if (this._status == 1 && isBomb == true) {\n      this._status = 2\n      this.playDieAction().then(() => {\n        this.onBlockPop(color, isChain, isBomb)\n      })\n      return\n    }\n\n    if (color.type) {\n      // 一定是用户主动触发 保存这个坐标给game\n      if (this.isSingle && this._itemType <= 1) {\n        this.node.scale = 1\n        this._game._score.tipBox.init(this._game._score, 3)\n        let action1 = cc.scaleTo(0.1, 1.1, 0.9)\n        let action2 = cc.scaleTo(0.3, 1).easing(cc.easeBackOut(2.0))\n        let action = cc.sequence(action1, action2)\n        this.node.runAction(action)\n        return\n      }\n      // console.log('方块位置', this.iid, this.jid, this._itemType)\n      color = this.color\n      if (this._status == 1 && this._game._status == 1 && this.color == color) {\n        this._game.onUserTouched(this.iid, this.jid, this._itemType, this.color, this.warningType, {\n          x: this.node.x,\n          y: this.node.y\n        })\n        this._game._score.onStep(-1).then((res) => {\n          if (res) {\n            this.playDieAction().then(() => {\n              this.onBlockPop(color, null, null)\n            })\n          }\n        })\n      }\n    } else {\n      // 由其他方块触发\n      if (this._status == 1 && this._game._status == 5 && this.color == color) {\n        this.playDieAction().then(() => {\n          this.onBlockPop(color, null, null)\n        })\n      }\n    }\n  },\n  onBlockPop(color, isChain, isBomb) {\n    let self = this\n    isChain = JSON.stringify(isChain) == 'null' ? true : isChain\n    isBomb = isBomb ? isBomb : false\n    self._game.checkNeedFall()\n    self._game._status = 5\n    self._controller.musicMgr.onPlayAudio(0\n      //self._game._score.chain - 1\n    )\n    if (this._itemType != 0) {\n      // console.log(\"触发了道具\", this._itemType)\n\n      self._game.onItem(this._itemType, this.color, {\n        x: this.node.x,\n        y: this.node.y\n      })\n    }\n    self._game._score.addScore(cc.v2(this.node.x, this.node.y - this.node.width + this._game.gap), this._itemType == 3 ? this._game._controller.config.json.propConfig[2].score : null)\n\n    // 连锁状态\n    if (isChain) {\n      if ((self.iid - 1) >= 0) {\n        self._game.map[self.iid - 1][self.jid].getComponent('cell').onTouched(color)\n      }\n      if ((self.iid + 1) < this._game.rowNum) {\n        self._game.map[self.iid + 1][self.jid].getComponent('cell').onTouched(color)\n      }\n      if ((self.jid - 1) >= 0) {\n        self._game.map[self.iid][self.jid - 1].getComponent('cell').onTouched(color)\n      }\n      if ((self.jid + 1) < this._game.rowNum) {\n        self._game.map[self.iid][self.jid + 1].getComponent('cell').onTouched(color)\n      }\n    }\n  },\n  playFallAction(y, data) { //下降了几个格子\n    this._status = 0\n    if (data) {\n      this.iid = data.y\n      this.jid = data.x\n    }\n    let action = cc.moveBy(0.25, 0, -y * (this._game.gap + this._game.blockWidth)).easing(cc.easeBounceOut(5 / y)) //1 * y / this._game.animationSpeed\n    let seq = cc.sequence(action, cc.callFunc(() => {\n      this._status = 1\n      //  this._game.checkNeedGenerator()\n    }, this))\n    this.node.runAction(seq)\n  },\n  playStartAction() {\n    this.node.scaleX = 0\n    this.node.scaleY = 0\n    let action = cc.scaleTo(0.8 / this._game.animationSpeed, 1, 1).easing(cc.easeBackOut())\n    let seq = cc.sequence(action, cc.callFunc(() => {\n      this._status = 1\n    }, this))\n    // 如果有延迟时间就用延迟时间\n    if (this.startTime) {\n      setTimeout(() => {\n          this.node.runAction(seq)\n        }, this.startTime / 1\n        // (cc.game.getFrameRate() / 60)\n      )\n    } else {\n      this.node.runAction(seq)\n    }\n  },\n  playDieAction() {\n    let self = this\n    clearTimeout(this.surfaceTimer)\n    this.node.stopAllActions()\n    this._status = 2\n    this.node.scaleX = 1\n    this.node.scaleY = 1\n    return new Promise((resolve, reject) => {\n      let action\n      if (this.warningSprite.spriteFrame) { //有道具预警\n        let action1 = cc.scaleTo(0.2 / self._game.animationSpeed, 1.1)\n        let action2 = cc.moveTo(0.2 / self._game.animationSpeed, this._game.target.x, this._game.target.y)\n        let action3 = cc.scaleTo(0.2, 0)\n        var seq = cc.sequence(action1, cc.callFunc(() => {\n          resolve('')\n        }, this), cc.spawn(action2, action3))\n      } else {\n        action = cc.scaleTo(0.2 / self._game.animationSpeed, 0, 0)\n        var seq = cc.sequence(action, cc.callFunc(() => {\n          resolve('')\n        }, this))\n      }\n      self.node.runAction(seq)\n    });\n  },\n  surfaceAction(dela) {\n    this.surfaceTimer = setTimeout(() => {\n      let action = cc.scaleTo(0.4 / this._game.animationSpeed, 0.8, 0.8)\n      let action1 = cc.scaleTo(0.4 / this._game.animationSpeed, 1, 1)\n      this.node.runAction(cc.sequence(action, action1))\n    }, dela)\n  },\n  generatePropAction() {\n\n  },\n  generateItem(type) {\n    this._itemType = type\n  },\n});"]}